{"version":3,"sources":["../../../../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","../../../../../../apps/web/src/app/page.tsx"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","'use client';\n\nimport { useState, useEffect } from 'react';\nimport { ChatResponse, Feedback } from '@fairyrealm/shared';\n\n// Hardcoded for MVP\nconst BOOKS = [\n    { id: 'book-1', title: 'The Little Prince' },\n    { id: 'book-2', title: 'Harry Potter' },\n];\n\nconst WORKER_URL = 'http://localhost:8787';\n\nexport default function Home() {\n    const [selectedBook, setSelectedBook] = useState(BOOKS[0].id);\n    const [messages, setMessages] = useState<any[]>([]);\n    const [input, setInput] = useState('');\n    const [loading, setLoading] = useState(false);\n    const [conversationId, setConversationId] = useState<string | undefined>(undefined);\n    const [userId] = useState('user-demo-' + Math.random().toString(36).substring(7)); // Demo user\n\n    const sendMessage = async () => {\n        if (!input.trim() || loading) return;\n\n        const userMsg = { role: 'user', content: input };\n        setMessages(prev => [...prev, userMsg]);\n        setInput('');\n        setLoading(true);\n\n        try {\n            const res = await fetch(`${WORKER_URL}/api/chat`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    userId,\n                    bookId: selectedBook,\n                    message: userMsg.content,\n                    conversationId\n                })\n            });\n\n            if (!res.ok) throw new Error('API Error');\n\n            const data: ChatResponse = await res.json();\n            setConversationId(data.conversationId);\n\n            const aiMsg = {\n                role: 'assistant',\n                content: data.reply,\n                feedback: data.feedback,\n                requireRewrite: data.requireRewrite\n            };\n            setMessages(prev => [...prev, aiMsg]);\n\n        } catch (err) {\n            console.error(err);\n            setMessages(prev => [...prev, { role: 'system', content: 'Error connecting to teacher.' }]);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <main className=\"container\">\n            <header>\n                <h1>FairyRealm üßö</h1>\n                <div className=\"book-selector\">\n                    <label>Choose a Book: </label>\n                    <select value={selectedBook} onChange={(e) => setSelectedBook(e.target.value)}>\n                        {BOOKS.map(b => <option key={b.id} value={b.id}>{b.title}</option>)}\n                    </select>\n                </div>\n            </header>\n\n            <div className=\"chat-window\">\n                {messages.map((m, i) => (\n                    <div key={i} className={`message ${m.role}`}>\n                        <div className=\"bubble\">\n                            {m.content}\n                        </div>\n                        {m.feedback && (\n                            <div className=\"feedback-card\">\n                                <h4>Teacher's Feedback:</h4>\n                                {m.feedback.grammar && <p><strong>Grammar:</strong> {m.feedback.grammar}</p>}\n                                {m.feedback.vocabulary && <p><strong>Vocabulary:</strong> {m.feedback.vocabulary}</p>}\n                                <p><em>{m.feedback.encouragement}</em></p>\n                                {m.requireRewrite && <div className=\"badge-retry\">Please rewrite this! ‚úçÔ∏è</div>}\n                            </div>\n                        )}\n                    </div>\n                ))}\n                {loading && <div className=\"message assistant\"><div className=\"bubble\">Thinking...</div></div>}\n            </div>\n\n            <div className=\"input-area\">\n                <input\n                    type=\"text\"\n                    value={input}\n                    onChange={(e) => setInput(e.target.value)}\n                    onKeyDown={(e) => e.key === 'Enter' && sendMessage()}\n                    placeholder=\"Type your answer in English...\"\n                />\n                <button onClick={sendMessage} disabled={loading}>Send</button>\n            </div>\n        </main>\n    );\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","ReactJsxRuntime","React"],"mappings":"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","ignoreList":[0,1,2]}