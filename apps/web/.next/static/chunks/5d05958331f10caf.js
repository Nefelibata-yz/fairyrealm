(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,39798,e=>{"use strict";var a=e.i(43476),r=e.i(71645);let t=[{id:"book-1",title:"The Little Prince"},{id:"book-2",title:"Harry Potter"}];function s(){let[e,s]=(0,r.useState)(t[0].id),[i,n]=(0,r.useState)([]),[c,l]=(0,r.useState)(""),[o,d]=(0,r.useState)(!1),[h,u]=(0,r.useState)(void 0),[b]=(0,r.useState)("user-demo-"+Math.random().toString(36).substring(7)),m=async()=>{if(!c.trim()||o)return;let a={role:"user",content:c};n(e=>[...e,a]),l(""),d(!0);try{let r=await fetch("http://localhost:8787/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:b,bookId:e,message:a.content,conversationId:h})});if(!r.ok)throw Error("API Error");let t=await r.json();u(t.conversationId);let s={role:"assistant",content:t.reply,feedback:t.feedback,requireRewrite:t.requireRewrite};n(e=>[...e,s])}catch(e){console.error(e),n(e=>[...e,{role:"system",content:"Error connecting to teacher."}])}finally{d(!1)}};return(0,a.jsxs)("main",{className:"container",children:[(0,a.jsxs)("header",{children:[(0,a.jsx)("h1",{children:"FairyRealm ðŸ§š"}),(0,a.jsxs)("div",{className:"book-selector",children:[(0,a.jsx)("label",{children:"Choose a Book: "}),(0,a.jsx)("select",{value:e,onChange:e=>s(e.target.value),children:t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))})]})]}),(0,a.jsxs)("div",{className:"chat-window",children:[i.map((e,r)=>(0,a.jsxs)("div",{className:`message ${e.role}`,children:[(0,a.jsx)("div",{className:"bubble",children:e.content}),e.feedback&&(0,a.jsxs)("div",{className:"feedback-card",children:[(0,a.jsx)("h4",{children:"Teacher's Feedback:"}),e.feedback.grammar&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Grammar:"})," ",e.feedback.grammar]}),e.feedback.vocabulary&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Vocabulary:"})," ",e.feedback.vocabulary]}),(0,a.jsx)("p",{children:(0,a.jsx)("em",{children:e.feedback.encouragement})}),e.requireRewrite&&(0,a.jsx)("div",{className:"badge-retry",children:"Please rewrite this! âœï¸"})]})]},r)),o&&(0,a.jsx)("div",{className:"message assistant",children:(0,a.jsx)("div",{className:"bubble",children:"Thinking..."})})]}),(0,a.jsxs)("div",{className:"input-area",children:[(0,a.jsx)("input",{type:"text",value:c,onChange:e=>l(e.target.value),onKeyDown:e=>"Enter"===e.key&&m(),placeholder:"Type your answer in English..."}),(0,a.jsx)("button",{onClick:m,disabled:o,children:"Send"})]})]})}e.s(["default",()=>s])}]);