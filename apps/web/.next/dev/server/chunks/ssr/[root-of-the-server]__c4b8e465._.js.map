{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/m4/Downloads/Y/Github/fairyrealm/apps/web/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { ChatResponse, Feedback } from '@fairyrealm/shared';\n\n// Hardcoded for MVP\nconst BOOKS = [\n    { id: 'book-1', title: 'The Little Prince' },\n    { id: 'book-2', title: 'Harry Potter' },\n];\n\nconst WORKER_URL = 'http://localhost:8787';\n\nexport default function Home() {\n    const [selectedBook, setSelectedBook] = useState(BOOKS[0].id);\n    const [messages, setMessages] = useState<any[]>([]);\n    const [input, setInput] = useState('');\n    const [loading, setLoading] = useState(false);\n    const [conversationId, setConversationId] = useState<string | undefined>(undefined);\n    const [userId] = useState('user-demo-' + Math.random().toString(36).substring(7)); // Demo user\n\n    const sendMessage = async () => {\n        if (!input.trim() || loading) return;\n\n        const userMsg = { role: 'user', content: input };\n        setMessages(prev => [...prev, userMsg]);\n        setInput('');\n        setLoading(true);\n\n        try {\n            const res = await fetch(`${WORKER_URL}/api/chat`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    userId,\n                    bookId: selectedBook,\n                    message: userMsg.content,\n                    conversationId\n                })\n            });\n\n            if (!res.ok) throw new Error('API Error');\n\n            const data: ChatResponse = await res.json();\n            setConversationId(data.conversationId);\n\n            const aiMsg = {\n                role: 'assistant',\n                content: data.reply,\n                feedback: data.feedback,\n                requireRewrite: data.requireRewrite\n            };\n            setMessages(prev => [...prev, aiMsg]);\n\n        } catch (err) {\n            console.error(err);\n            setMessages(prev => [...prev, { role: 'system', content: 'Error connecting to teacher.' }]);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <main className=\"container\">\n            <header>\n                <h1>FairyRealm üßö</h1>\n                <div className=\"book-selector\">\n                    <label>Choose a Book: </label>\n                    <select value={selectedBook} onChange={(e) => setSelectedBook(e.target.value)}>\n                        {BOOKS.map(b => <option key={b.id} value={b.id}>{b.title}</option>)}\n                    </select>\n                </div>\n            </header>\n\n            <div className=\"chat-window\">\n                {messages.map((m, i) => (\n                    <div key={i} className={`message ${m.role}`}>\n                        <div className=\"bubble\">\n                            {m.content}\n                        </div>\n                        {m.feedback && (\n                            <div className=\"feedback-card\">\n                                <h4>Teacher's Feedback:</h4>\n                                {m.feedback.grammar && <p><strong>Grammar:</strong> {m.feedback.grammar}</p>}\n                                {m.feedback.vocabulary && <p><strong>Vocabulary:</strong> {m.feedback.vocabulary}</p>}\n                                <p><em>{m.feedback.encouragement}</em></p>\n                                {m.requireRewrite && <div className=\"badge-retry\">Please rewrite this! ‚úçÔ∏è</div>}\n                            </div>\n                        )}\n                    </div>\n                ))}\n                {loading && <div className=\"message assistant\"><div className=\"bubble\">Thinking...</div></div>}\n            </div>\n\n            <div className=\"input-area\">\n                <input\n                    type=\"text\"\n                    value={input}\n                    onChange={(e) => setInput(e.target.value)}\n                    onKeyDown={(e) => e.key === 'Enter' && sendMessage()}\n                    placeholder=\"Type your answer in English...\"\n                />\n                <button onClick={sendMessage} disabled={loading}>Send</button>\n            </div>\n        </main>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///Users/m4/Downloads/Y/Github/fairyrealm/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0]}},
    {"offset": {"line": 310, "column": 0}, "map": {"version":3,"sources":["file:///Users/m4/Downloads/Y/Github/fairyrealm/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///Users/m4/Downloads/Y/Github/fairyrealm/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0]}}]
}